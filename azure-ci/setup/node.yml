parameters:
  cache: true
  versionNode: '14.x'
  workingDirectory: '$(System.DefaultWorkingDirectory)'
  yarnCachePath: '$(Pipeline.Workspace)/.yarn/cache'

steps:
  - task: Cache@2
    condition: eq(${{ parameters.cache }}, true)
    inputs:
      key: 'yarn | "$(Agent.OS)" | yarn.lock'
      path: ${{ parameters.yarnCachePath }}
      restoreKeys: |
        yarn | "$(Agent.OS)"
        yarn
    displayName: 'Cache Yarn Packages'
  - task: NodeTool@0
    inputs:
      versionSpec: ${{ parameters.versionNode }}
    displayName: 'Install Node'
  - script: |
      node --version
      yarn --version
      yarn install
    displayName: 'Install Packages'
    workingDirectory: '${{ parameters.workingDirectory }}'
