parameters:
  path: "$(System.DefaultWorkingDirectory)"

jobs:
  - job: "Build_App"
    displayName: "App"
    pool:
      name: "Default"
      vmImage: "ubuntu-latest"
    steps:
      - task: Cache@2
        inputs:
          key: 'yarn | "$(Agent.OS)" | yarn.lock'
          path: $(yarnCachePath)
          restoreKeys: |
            yarn | "$(Agent.OS)"
            yarn
        displayName: "Cache Yarn Packages"
      - task: NodeTool@0
        inputs:
          versionSpec: $(versionNode)
        displayName: "Install Node.js"
      - script: |
          yarn install  --pure-lockfile --cache-folder $(yarnCachePath)
        displayName: "Install"
      - script: |
          node --version
          yarn --version
          yarn run build --production
        displayName: "Build"
      - task: PublishBuildArtifacts@1
        inputs:
          PathtoPublish: "build"
          ArtifactName: "app"
          publishLocation: "Container"
        displayName: "Publish"
